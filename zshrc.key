export LOGNAME=key
export USER=key
export EDITOR=nvr\ -o

alias vim="nvim"
alias vf="git grep --open-files-in-pager=$EDITOR"
alias dcrun="docker-compose run --rm"
alias dcdev="docker-compose -f docker-compose-dev.yml run"
alias rubocop="dcrun -w /app console bundle exec rubocop -D $@"

function rspec() {
  wdir=''
  vcr=''
  [ -f 'docker-compose.yml' ] || wdir=/$(basename $(pwd))
  [ -n "$VCR_UP" ] && vcr=" -e VCR_UP=1"
  dcrun -w /app/$wdir -e RACK_ENV=test -e APP_ENV=test $(echo $vcr) console bundle exec rspec "$@"
}

function bundle() {
  wdir=''
  [ -f 'docker-compose.yml' ] || wdir=/$(basename $(pwd))
  dcrun -w /app$wdir -e RACK_ENV=test -e APP_ENV=test console bundle $@
}
